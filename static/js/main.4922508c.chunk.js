(this.webpackJsonpqserver2=this.webpackJsonpqserver2||[]).push([[0],{30:function(e,a,t){},37:function(e,a,t){e.exports=t.p+"static/media/logo.5d5d9eef.svg"},42:function(e,a,t){e.exports=t(63)},50:function(e,a,t){},51:function(e,a,t){},61:function(e,a,t){},63:function(e,a,t){"use strict";t.r(a);var n=t(2),o=t.n(n),r=t(22),l=t.n(r),c=t(9),s=t(10),u=t(12),i=t(11),m=(t(30),t(41)),d=t(40),p=t(23),v=(t(50),function(e){Object(u.a)(t,e);var a=Object(i.a)(t);function t(){return Object(c.a)(this,t),a.apply(this,arguments)}return Object(s.a)(t,[{key:"render",value:function(){var e=this.props,a=e.value,t=e.clickHandler,n="X"===a?"square-1":"square-2";return console.log("cls: "+n),o.a.createElement("span",{className:n,onClick:function(){t()}},a)}}]),t}(o.a.Component)),h=function(e){Object(u.a)(t,e);var a=Object(i.a)(t);function t(){return Object(c.a)(this,t),a.apply(this,arguments)}return Object(s.a)(t,[{key:"cellClickHandler",value:function(e){alert(e+" clicked")}},{key:"render",value:function(){var e=this,a=[];return this.props.board.map((function(t,n){console.log("val: "+t+" || index: "+n),a.push(o.a.createElement("div",null,o.a.createElement(v,{key:n,value:t,clickHandler:function(){return e.cellClickHandler(n)}})))})),o.a.createElement("div",{className:"board"},a)}}]),t}(o.a.Component),f=(t(51),p.a.initializeApp({apiKey:"AIzaSyCJcKHsm9yfeCIZcQtwIgz7j8j0v_lJUFQ",authDomain:"queuesapp-415d3.firebaseapp.com",databaseURL:"https://queuesapp-415d3.firebaseio.com",projectId:"queuesapp-415d3",storageBucket:"queuesapp-415d3.appspot.com",messagingSenderId:"1023683818860",appId:"1:1023683818860:web:fbdb633ee95a930c"}).firestore()),g=function(e){Object(u.a)(t,e);var a=Object(i.a)(t);function t(e){var n;return Object(c.a)(this,t),(n=a.call(this,e)).state={board:[],servingQNum:0,lastQNum:0},n}return Object(s.a)(t,[{key:"componentDidMount",value:function(){this.updateQueue("queue_"+this.props.queue)}},{key:"addToQueue",value:function(e,a,t){console.log("add to Queue"),this.setState({board:this.state.board.concat(e),lastQNum:a,servingQNum:t})}},{key:"updateQueue",value:function(e){var a=this;console.log("updateQueue called"),f.collection("SweeCafe").doc(e).onSnapshot({includeMetadataChanges:!0},(function(e){var t=e.data().name,n=e.data().rear_no,o=e.data().serving_no;if(console.log("queue_name: (firebase)",t),console.log("serving_no: (firebase)",o),console.log("servingQNum: (local)",a.state.servingQNum),console.log("lastQNum: (local)",a.state.lastQNum),0===a.state.lastQNum){console.log("A ...");for(var r=1;r<=n;r++)r<=o?a.addToQueue("X",n,o):a.addToQueue(a.props.queue+r,n,o)}else 1===n&&0===o?(console.log("B ..."),a.setState({board:[],lastQNum:0})):n>a.state.lastQNum?(console.log("C ..."),console.log("rear_num_from_firebase: "+n),console.log("lastQNum: "+a.state.lastQNum),a.addToQueue(a.props.queue+n,n,o)):o>a.state.servingQNum&&(console.log("D ..."),a.updateServingQNum(o))}))}},{key:"updateServingQNum",value:function(e){var a=e-1,t=Object(d.a)(this.state.board);Object(m.a)({},t[a]);t[a]="X",this.setState({board:t,servingQNum:e})}},{key:"next",value:function(){this.state.servingQNum<this.state.lastQNum?f.collection("SweeCafe").doc("queue_"+this.props.queue).update({serving_no:p.a.firestore.FieldValue.increment(1)},{merge:!0}).then((function(){console.log("Document successfully written!")})).catch((function(e){console.error("Error writing document: ",e)})):alert("Alert:  Reached end of queue!")}},{key:"reset",value:function(){f.collection("SweeCafe").doc("queue_"+this.props.queue).set({serving_no:0,rear_no:1},{merge:!0}).then((function(){console.log("Document successfully written!")})).catch((function(e){console.error("Error writing document: ",e)}));var e="SweeCafe/queue_"+this.props.queue+"/LiveQueues";f.collection(e).get().then((function(e){e.forEach((function(e){e.ref.delete()}))}))}},{key:"render",value:function(){return console.log("<<< rendering >>>"),o.a.createElement("div",{className:"queue"},o.a.createElement("div",{className:"displayBox"},o.a.createElement("p",null,"Currently serving: ",o.a.createElement("strong",null," ",this.props.queue,this.state.servingQNum," ")),o.a.createElement("p",null,"Last in queue: ",o.a.createElement("strong",null," ",this.props.queue,this.state.lastQNum," "))),o.a.createElement("div",{className:"queue-body"},o.a.createElement(h,{board:this.state.board})),o.a.createElement("button",{className:"nextButton",variant:"primary",onClick:this.next.bind(this)},"Next"),o.a.createElement("br",null),o.a.createElement("button",{className:"nextButton",variant:"primary",onClick:this.reset.bind(this)},"RESET"))}}]),t}(o.a.Component),b=t(36),E=t(37),N=t.n(E),Q=function(e){Object(u.a)(t,e);var a=Object(i.a)(t);function t(){var e;Object(c.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=a.call.apply(a,[this].concat(o))).scrollToTop=function(){b.animateScroll.scrollToTop()},e}return Object(s.a)(t,[{key:"render",value:function(){return o.a.createElement("nav",{className:"nav",id:"navbar"},o.a.createElement("div",{className:"nav-content"},o.a.createElement("img",{src:N.a,className:"nav-logo",alt:"Logo",onClick:this.scrollToTop}),o.a.createElement("h2",null,"QServer")))}}]),t}(n.Component),y=t(38),_=t(24),q=t(39),k=function(e){Object(u.a)(t,e);var a=Object(i.a)(t);function t(){return Object(c.a)(this,t),a.apply(this,arguments)}return Object(s.a)(t,[{key:"render",value:function(){return console.log("<<< rendering 1 >>>"),o.a.createElement(o.a.Fragment,null,o.a.createElement(Q,null),o.a.createElement("main",{className:"container"},o.a.createElement(y.a,null,o.a.createElement(q.a,null,o.a.createElement(_.a,null,o.a.createElement("h3",{className:"header"},"Queue A"),o.a.createElement("div",{className:"app__content"},o.a.createElement("div",{className:"app__header"}),o.a.createElement("div",{className:"app__body"},o.a.createElement(g,{queue:"A"})))),o.a.createElement(_.a,null,o.a.createElement("h3",{className:"header"},"Queue B"),o.a.createElement("div",{className:"app__content"},o.a.createElement("div",{className:"app__header"}),o.a.createElement("div",{className:"app__body"},o.a.createElement(g,{queue:"B"})))),o.a.createElement(_.a,null,o.a.createElement("h3",{className:"header"},"Queue C"),o.a.createElement("div",{className:"app__content"},o.a.createElement("div",{className:"app__header"}),o.a.createElement("div",{className:"app__body"},o.a.createElement(g,{queue:"C"}))))))))}}]),t}(n.Component);t(61),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));t(62);l.a.render(o.a.createElement(k,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[42,1,2]]]);
//# sourceMappingURL=main.4922508c.chunk.js.map